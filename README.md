





project Requirements: 

Implementation of a simple payment provider. This “simulated” provider works only with the request data, its own persisted data and the business rules defined in this document, no external payment system is contacted.

Functional Requirements
Payment transactions

•	Payment provider processes payment requests for orders coming from different clients

•	Payment requests may contain following fields: client ID, order ID (generated by the client and unique per client), amount, transaction type, currency, payment method, payment token ID (represents e.g. credit card)

•	Supported currencies: EUR, USD, GBP

•	Supported payment methods: CARD, INVOICE, CASH

•	Supported payment transaction types: REGISTER (initial state), AUTHORISE (reserves amount), CAPTURE (takes amount - successful payment), REVERSE (reverses previous state(s) - payment cancelled)

•	Supported payment transaction statuses (for all transaction types): SUCCESS, ERROR

•	Transactions for specific payment can only be created in the following order, assuming they are successful:

◦	REGISTER => AUTHORISE | REVERSE

◦	AUTHORISE => CAPTURE | REVERSE

◦	CAPTURE => REVERSE

•	There could be multiple unsuccessful payment transactions for specific order

•	Multiple successful payments for the same order should be prevented

•	All payment transactions must be registered and stored in persistent storage

Reporting

•	Find payment status for specific order

•	Find pending payments (which are not successfully captured or reversed) for specific client

•	Find total of payment amounts for all successful payments for specific client and time period


 

Examples

Here are few scenarios illustrating the required usage of this application (your implementation doesn't have to be exactly like this):


$ java -jar paymentprovider.jar
Please specify a command. Available commands: register, authorise, capture, reverse, findByOrder, findPending, findTotal


/
/
/


$ java -jar paymentprovider.jar register --clientId="IBE" --orderId="book-37843" --amount="250" --currency="EUR" --payMethod="PAYPAL" --payTokenId="pp-32f45c932d776"

register: status="ERROR", message="Invalid payment method PAYPAL"

/

/

/




$ java -jar paymentprovider.jar register clientId="IBE" orderId="book-37843" transactionType="REGISTER" amount="250" currency="EUR" payMethod="CARD" payTokenId="cc-367b9832f651a01"

register: status="SUCCES"
 

/
/
/


 
$ java -jar paymentprovider.jar findByOrder clientId="IBE" orderId="book-37843"

findByOrder:
clientId="IBE", orderId="book-37843", amount="250", currency="EUR", payMethod="CARD", status="CAPTURED"

/
/
/





$ java -jar paymentprovider.jar findPending clientId="IBE"

findPending:
clientId="IBE", orderId="book-32761", amount="110", currency="USD", payMethod="CARD", status="REGISTERED"

clientId="IBE", orderId="book-33256", amount="750", currency="EUR", payMethod="CASH", status="AUTHORISED"


/
/
/

Non-functional Requirements

•	Application should be a standalone Java application and preferred technology stack is: Java 8, MySql, Spring, Hibernate, Log4j, Maven.




Results:


register --clientId="IBE" --orderId="book-37843" --transactionType="REGISTER" --amount="250" --currency="EUR" --payMethod="CARD" --payTokenId="cc-367b9832f651a01"

**register: status='SUCCESS'**


register --clientId="AMD" --orderId="book-25896" --transactionType="REGISTER" --amount="150" --currency="EUR" --payMethod="CASH" --payTokenId="cc-367b9832f651a11"

**register: status='SUCCESS'**


authorise --clientId="AMD" --orderId="book-25896" --transactionType="AUTHORISE" --amount="150" --currency="EUR" --payMethod="CASH" --payTokenId="cc-367b9832f651a11"

**authorise: status='SUCCESS'**


authorise --clientId="IBE" --orderId="book-37843" --transactionType="AUTHORISE" --amount="250" --currency="EUR" --payMethod="CARD" --payTokenId="cc-367b9832f651a01"

**authorise: status='SUCCESS'**


capture --clientId="AMD" --orderId="book-25896" --transactionType="CAPTURE" --amount="150" --currency="EUR" --payMethod="CASH" --payTokenId="cc-367b9832f651a11"

**capture: status='SUCCESS'**


findPending --clientId="AMD"

**null**



findPending --clientId="IBE"

**{"clientId":"IBE","orderId":"book-37843","date":{"year":2020,"month":1,"day":26},"amount":250,"currency":"EUR","payMethod":"CARD","transactionType":"REGISTER","payTokenId":"cc-367b9832f651a01","status":"AUTHORISED"}**



capture --clientId="AMD" --orderId="book-25896" --transactionType="CAPTURE" --amount="150" --currency="INR" --payMethod="CASH" --payTokenId="cc-367b9832f651a11"

**status='ERROR', message='Invalid currency INR or payment Method - CASH**




reverse --clientId="IBE" --orderId="book-37843" --amount="250" --currency="EUR" --payMethod="CARD" --payTokenId="cc-367b9832f651a01"

**reverse: status='SUCCESS'**


reverse --clientId="AMD" --orderId="book-25896" --amount="150" --currency="EUR" --payMethod="CASH" --payTokenId="cc-367b9832f651a11"

**reverse: status='SUCCESS'**


authorise --clientId="IBE" --orderId="book-37843" --transactionType="AUTHORISE" --amount="250" --currency="EUR" --payMethod="CARD" --payTokenId="cc-367b9832f651a01"

**status='ERROR', message='transaction is not in REGISTERED state**


findByOrder --clientId="IBE" --orderId="book-37843"

**{"clientId":"IBE","orderId":"book-37843","date":{"year":2020,"month":1,"day":26},"amount":250,"currency":"EUR","payMethod":"CARD","transactionType":"REGISTER","payTokenId":"cc-367b9832f651a01","status":"REVERSED"}**












